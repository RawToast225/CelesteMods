generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "mysql"
  url      = env("DATABASE_URL")
}

model archive_map {
  id                                  Int               @id @default(autoincrement()) @db.UnsignedMediumInt
  mapID                               Int               @db.UnsignedMediumInt
  modID                               Int               @db.UnsignedSmallInt
  mapperUserID                        Int?              @db.UnsignedSmallInt
  mapperNameString                    String            @db.VarChar(50)
  name                                String            @db.VarChar(200)
  canonicalDifficultyID               Int               @db.UnsignedSmallInt
  lengthID                            Int               @db.UnsignedTinyInt
  description                         String?           @db.VarChar(500)
  notes                               String?           @db.VarChar(500)
  chapter                             Int?              @db.UnsignedTinyInt
  side                                archive_map_side?
  overallRank                         Int?              @db.UnsignedTinyInt
  mapRemovedFromModBool               Boolean           @default(false)
  timeSubmitted                       Int
  submittedBy                         Int?              @db.UnsignedSmallInt
  timeApproved                        Int?
  approvedBy                          Int?              @db.UnsignedSmallInt
  timeArchived                        Int
  map                                 map               @relation(fields: [mapID], references: [id], onDelete: Cascade, onUpdate: Restrict, map: "archive_map_ibfk_0")
  mod                                 mod               @relation(fields: [modID], references: [id], onDelete: Cascade, onUpdate: Restrict, map: "archive_map_ibfk_1")
  user_archive_map_mapperUserIDTouser user?             @relation("archive_map_mapperUserIDTouser", fields: [mapperUserID], references: [id], onUpdate: Restrict, map: "archive_map_ibfk_2")
  difficulty                          difficulty        @relation(fields: [canonicalDifficultyID], references: [id], onUpdate: Restrict, map: "archive_map_ibfk_3")
  length                              length            @relation(fields: [lengthID], references: [id], onUpdate: Restrict, map: "archive_map_ibfk_4")
  user_archive_map_submittedByTouser  user?             @relation("archive_map_submittedByTouser", fields: [submittedBy], references: [id], onUpdate: Restrict, map: "archive_map_ibfk_5")
  user_archive_map_approvedByTouser   user?             @relation("archive_map_approvedByTouser", fields: [approvedBy], references: [id], onUpdate: Restrict, map: "archive_map_ibfk_6")

  @@unique([modID, chapter, side], map: "modChapterSide")
  @@index([approvedBy], map: "approvedBy")
  @@index([canonicalDifficultyID], map: "canonicalDifficultyID")
  @@index([lengthID], map: "lengthID")
  @@index([mapID], map: "mapID")
  @@index([mapperUserID], map: "mapperUserID")
  @@index([modID], map: "modID")
  @@index([submittedBy], map: "submittedBy")
}

model archive_mod {
  id                    Int              @id @db.UnsignedSmallInt
  modID                 Int              @db.UnsignedSmallInt
  type                  archive_mod_type @default(Normal)
  name                  String           @db.VarChar(200)
  publisherID           Int              @db.UnsignedSmallInt
  contentWarning        Boolean          @default(false)
  notes                 String?          @db.VarChar(500)
  shortDescription      String           @db.VarChar(150)
  longDescription       String?          @db.VarChar(1500)
  gamebananaModID       Int              @db.UnsignedMediumInt
  timeSubmitted         Int
  submittedBy           Int?             @db.UnsignedSmallInt
  timeApproved          Int?
  approvedBy            Int?             @db.UnsignedSmallInt
  timeCreatedGamebanana Int
  timeArchived          Int
  mod                   mod              @relation(fields: [modID], references: [id], onDelete: Cascade, onUpdate: Restrict, map: "archive_mod_ibfk_0")
  publisher             publisher        @relation(fields: [publisherID], references: [id], onDelete: Cascade, onUpdate: Restrict, map: "archive_mod_ibfk_1")
  user                  user?            @relation(fields: [submittedBy], references: [id], onUpdate: Restrict, map: "archive_mod_ibfk_2")

  @@index([approvedBy], map: "approvedBy")
  @@index([contentWarning], map: "contentWarning")
  @@index([modID], map: "modID")
  @@index([publisherID], map: "publisherID")
  @@index([submittedBy], map: "submittedBy")
}

model difficulty {
  id                 Int           @id @default(autoincrement()) @db.UnsignedSmallInt
  name               String        @db.VarChar(50)
  description        String?       @db.VarChar(100)
  parentDifficultyID Int?          @default(0) @db.UnsignedSmallInt
  order              Int           @db.UnsignedTinyInt
  archive_map        archive_map[]
  difficulty         difficulty?   @relation("difficultyTodifficulty", fields: [parentDifficultyID], references: [id], onDelete: Cascade, onUpdate: Restrict, map: "difficulty_ibfk_2")
  other_difficulty   difficulty[]  @relation("difficultyTodifficulty")
  map                map[]
  rating             rating[]
  tech               tech[]

  @@unique([parentDifficultyID, name], map: "uniqueName")
  @@unique([parentDifficultyID, order], map: "uniqueOrder")
  @@index([parentDifficultyID], map: "difficulties_ibfk_2")
}

model length {
  id          Int           @id @default(autoincrement()) @db.UnsignedTinyInt
  name        String        @db.VarChar(20)
  description String        @db.VarChar(100)
  order       Int           @unique(map: "order") @db.UnsignedTinyInt
  archive_map archive_map[]
  map         map[]
  review_map  review_map[]
}

model map {
  id                          Int             @id @default(autoincrement()) @db.UnsignedMediumInt
  modID                       Int             @db.UnsignedSmallInt
  mapperUserID                Int?            @db.UnsignedSmallInt
  mapperNameString            String          @db.VarChar(50)
  name                        String          @db.VarChar(200)
  canonicalDifficultyID       Int             @db.UnsignedSmallInt
  lengthID                    Int             @db.UnsignedTinyInt
  description                 String?         @db.VarChar(500)
  notes                       String?         @db.VarChar(500)
  chapter                     Int?            @db.UnsignedTinyInt
  side                        map_side?
  overallRank                 Int?            @db.UnsignedTinyInt
  mapRemovedFromModBool       Boolean         @default(false)
  timeSubmitted               Int
  submittedBy                 Int?            @db.UnsignedSmallInt
  timeApproved                Int?
  approvedBy                  Int?            @db.UnsignedSmallInt
  archive_map                 archive_map[]
  mod                         mod             @relation(fields: [modID], references: [id], onDelete: Cascade, onUpdate: Restrict, map: "map_ibfk_1")
  user_map_mapperUserIDTouser user?           @relation("map_mapperUserIDTouser", fields: [mapperUserID], references: [id], onUpdate: Restrict, map: "map_ibfk_2")
  difficulty                  difficulty      @relation(fields: [canonicalDifficultyID], references: [id], onUpdate: Restrict, map: "map_ibfk_3")
  length                      length          @relation(fields: [lengthID], references: [id], onUpdate: Restrict, map: "map_ibfk_4")
  user_map_submittedByTouser  user?           @relation("map_submittedByTouser", fields: [submittedBy], references: [id], onUpdate: Restrict, map: "map_ibfk_5")
  user_map_approvedByTouser   user?           @relation("map_approvedByTouser", fields: [approvedBy], references: [id], onUpdate: Restrict, map: "map_ibfk_6")
  maps_to_techs               maps_to_techs[]
  rating                      rating[]
  review_map                  review_map[]
  users_to_maps               users_to_maps[]

  @@unique([modID, chapter, side], map: "modChapterSide")
  @@index([approvedBy], map: "approvedBy")
  @@index([canonicalDifficultyID], map: "canonicalDifficultyID")
  @@index([lengthID], map: "lengthID")
  @@index([mapperUserID], map: "mapperUserID")
  @@index([modID], map: "modID")
  @@index([submittedBy], map: "submittedBy")
}

model maps_to_techs {
  mapID             Int     @db.UnsignedMediumInt
  techID            Int     @db.UnsignedSmallInt
  fullClearOnlyBool Boolean @default(false)
  map               map     @relation(fields: [mapID], references: [id], onDelete: Cascade, onUpdate: Restrict, map: "maps_to_techs_ibfk_1")
  tech              tech    @relation(fields: [techID], references: [id], onDelete: Cascade, onUpdate: Restrict, map: "maps_to_techs_ibfk_2")

  @@id([mapID, techID])
  @@index([techID], map: "techID")
}

model mod {
  id                         Int           @id @default(autoincrement()) @db.UnsignedSmallInt
  type                       mod_type      @default(Normal)
  name                       String        @db.VarChar(200)
  publisherID                Int           @db.UnsignedSmallInt
  contentWarning             Boolean       @default(false)
  notes                      String?       @db.VarChar(500)
  shortDescription           String        @db.VarChar(150)
  longDescription            String?       @db.VarChar(1500)
  gamebananaModID            Int           @unique(map: "gamebananaModID") @db.UnsignedMediumInt
  timeSubmitted              Int
  submittedBy                Int?          @db.UnsignedSmallInt
  timeApproved               Int?
  approvedBy                 Int?          @db.UnsignedSmallInt
  timeCreatedGamebanana      Int
  archive_map                archive_map[]
  archive_mod                archive_mod[]
  map                        map[]
  publisher                  publisher     @relation(fields: [publisherID], references: [id], onDelete: Cascade, onUpdate: Restrict, map: "mod_ibfk_1")
  user_mod_submittedByTouser user?         @relation("mod_submittedByTouser", fields: [submittedBy], references: [id], onUpdate: Restrict, map: "mod_ibfk_2")
  user_mod_approvedByTouser  user?         @relation("mod_approvedByTouser", fields: [approvedBy], references: [id], onUpdate: Restrict, map: "mod_ibfk_3")
  review                     review[]

  @@index([approvedBy], map: "approvedBy")
  @@index([contentWarning], map: "contentWarning")
  @@index([publisherID], map: "publisherID")
  @@index([submittedBy], map: "submittedBy")
}

model publisher {
  id           Int           @id @default(autoincrement()) @db.UnsignedSmallInt
  gamebananaID Int?          @unique(map: "gamebananaID") @db.UnsignedMediumInt
  name         String        @db.VarChar(100)
  userID       Int?          @db.UnsignedSmallInt
  archive_mod  archive_mod[]
  mod          mod[]
  user         user?         @relation(fields: [userID], references: [id], onUpdate: Restrict, map: "publisher_ibfk_1")

  @@index([userID], map: "userID")
}

model quality {
  id          Int      @id @default(autoincrement()) @db.UnsignedTinyInt
  name        String   @db.VarChar(20)
  description String   @db.VarChar(100)
  order       Int      @unique(map: "order") @db.UnsignedTinyInt
  rating      rating[]
}

model rating {
  id            Int         @id @default(autoincrement()) @db.UnsignedInt
  mapID         Int         @db.UnsignedMediumInt
  submittedBy   Int         @db.UnsignedSmallInt
  timeSubmitted Int
  qualityID     Int?        @db.UnsignedTinyInt
  difficultyID  Int?        @db.UnsignedSmallInt
  user          user        @relation(fields: [submittedBy], references: [id], onDelete: Cascade, onUpdate: Restrict, map: "rating_ibfk_1")
  map           map         @relation(fields: [mapID], references: [id], onDelete: Cascade, onUpdate: Restrict, map: "rating_ibfk_2")
  difficulty    difficulty? @relation(fields: [difficultyID], references: [id], onDelete: Restrict, onUpdate: Restrict, map: "rating_ibfk_3")
  quality       quality?    @relation(fields: [qualityID], references: [id], onDelete: Cascade, onUpdate: Restrict, map: "rating_ibfk_4")

  @@unique([mapID, submittedBy], map: "mapAndUser")
  @@index([difficultyID], map: "difficultyID")
  @@index([mapID], map: "mapID")
  @@index([qualityID], map: "qualityID")
  @@index([submittedBy], map: "submittedBy")
}

model review {
  id                 Int               @id @default(autoincrement()) @db.UnsignedMediumInt
  modID              Int               @db.UnsignedSmallInt
  reviewCollectionID Int               @db.UnsignedSmallInt
  timeSubmitted      Int
  likes              String?           @db.VarChar(1000)
  dislikes           String?           @db.VarChar(1000)
  otherComments      String?           @db.VarChar(1500)
  mod                mod               @relation(fields: [modID], references: [id], onDelete: Cascade, onUpdate: Restrict, map: "review_ibfk_1")
  review_collection  review_collection @relation(fields: [reviewCollectionID], references: [id], onDelete: Cascade, onUpdate: Restrict, map: "review_ibfk_2")
  review_map         review_map[]

  @@unique([modID, reviewCollectionID], map: "modAndReviewCollection")
  @@index([modID], map: "modID")
  @@index([reviewCollectionID], map: "reviewCollectionID")
}

model review_collection {
  id          Int      @id @default(autoincrement()) @db.UnsignedSmallInt
  userID      Int      @db.UnsignedSmallInt
  name        String   @db.VarChar(100)
  description String   @db.VarChar(500)
  review      review[]
  user        user     @relation(fields: [userID], references: [id], onDelete: Cascade, onUpdate: Restrict, map: "review_collection_ibfk_1")

  @@index([userID], map: "userID")
}

model review_map {
  id                Int     @id @default(autoincrement()) @db.UnsignedInt
  reviewID          Int     @db.UnsignedMediumInt
  mapID             Int     @db.UnsignedMediumInt
  lengthID          Int     @db.UnsignedTinyInt
  likes             String? @db.VarChar(500)
  dislikes          String? @db.VarChar(500)
  otherComments     String? @db.VarChar(500)
  displayRatingBool Boolean @default(false)
  length            length  @relation(fields: [lengthID], references: [id], onUpdate: Restrict, map: "review_map_ibfk_2")
  map               map     @relation(fields: [mapID], references: [id], onDelete: Cascade, onUpdate: Restrict, map: "review_map_ibfk_3")
  review            review  @relation(fields: [reviewID], references: [id], onDelete: Cascade, onUpdate: Restrict, map: "review_map_ibfk_4")

  @@unique([reviewID, mapID], map: "review_map")
  @@index([lengthID], map: "lengthID")
  @@index([mapID], map: "mapID")
  @@index([reviewID], map: "reviewID")
}

model session {
  id        String   @id @db.VarChar(750)
  sid       String   @unique(map: "sid") @db.VarChar(750)
  data      String   @db.Text
  expiresAt DateTime @db.DateTime(0)
}

model tech {
  id                  Int             @id @default(autoincrement()) @db.UnsignedSmallInt
  name                String          @unique(map: "name") @db.VarChar(50)
  description         String?         @db.VarChar(150)
  defaultDifficultyID Int             @db.UnsignedSmallInt
  maps_to_techs       maps_to_techs[]
  difficulty          difficulty      @relation(fields: [defaultDifficultyID], references: [id], onUpdate: Restrict, map: "tech_ibfk_1")
  tech_video          tech_video[]

  @@index([defaultDifficultyID], map: "defaultDifficultyID")
}

model tech_video {
  id     Int    @id @default(autoincrement()) @db.UnsignedSmallInt
  techID Int    @db.UnsignedSmallInt
  url    String @db.VarChar(100)
  tech   tech   @relation(fields: [techID], references: [id], onDelete: Cascade, onUpdate: Restrict, map: "tech_video_ibfk_1")

  @@index([techID], map: "techID")
}

model user {
  id                                         Int                 @id @default(autoincrement()) @db.UnsignedSmallInt
  displayName                                String              @db.VarChar(50)
  discordID                                  String?             @unique(map: "discordID") @db.VarChar(50)
  discordUsername                            String              @db.VarChar(32)
  discordDiscrim                             String              @db.VarChar(4)
  displayDiscord                             Boolean
  showCompletedMaps                          Boolean
  timeCreated                                Int
  permissions                                String
  accountStatus                              user_accountStatus  @default(Active)
  timeDeletedOrBanned                        Int?
  archive_map_archive_map_mapperUserIDTouser archive_map[]       @relation("archive_map_mapperUserIDTouser")
  archive_map_archive_map_submittedByTouser  archive_map[]       @relation("archive_map_submittedByTouser")
  archive_map_archive_map_approvedByTouser   archive_map[]       @relation("archive_map_approvedByTouser")
  archive_mod                                archive_mod[]
  map_map_mapperUserIDTouser                 map[]               @relation("map_mapperUserIDTouser")
  map_map_submittedByTouser                  map[]               @relation("map_submittedByTouser")
  map_map_approvedByTouser                   map[]               @relation("map_approvedByTouser")
  mod_mod_submittedByTouser                  mod[]               @relation("mod_submittedByTouser")
  mod_mod_approvedByTouser                   mod[]               @relation("mod_approvedByTouser")
  publisher                                  publisher[]
  rating                                     rating[]
  review_collection                          review_collection[]
  users_to_maps                              users_to_maps[]

  @@unique([discordUsername, discordDiscrim], map: "discordTag")
}

model users_to_maps {
  userID Int  @db.UnsignedSmallInt
  mapID  Int  @db.UnsignedMediumInt
  user   user @relation(fields: [userID], references: [id], onDelete: Cascade, onUpdate: Restrict, map: "users_to_maps_ibfk_1")
  map    map  @relation(fields: [mapID], references: [id], onDelete: Cascade, onUpdate: Restrict, map: "users_to_maps_ibfk_2")

  @@id([userID, mapID])
  @@index([mapID], map: "mapID")
}

enum mod_type {
  Normal
  Collab
  Contest
  LobbyOther
}

enum archive_mod_type {
  Normal
  Collab
  Contest
  LobbyOther
}

enum user_accountStatus {
  Active
  Deleted
  Banned
  Unlinked
}

enum map_side {
  A
  B
  C
  D
  E
}

enum archive_map_side {
  A
  B
  C
  D
  E
}
